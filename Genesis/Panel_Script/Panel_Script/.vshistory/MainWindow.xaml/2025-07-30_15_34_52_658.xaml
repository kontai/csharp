<Window x:Class="Panel_Script.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Panel_Script"
        mc:Ignorable="d"
        Loaded="Window_Loaded"
        Title="MainWindow" Height="810" Width="800">
    <Window.Resources>

        <!-- 新增配色資源 -->
        <SolidColorBrush x:Key="PrimaryColor" Color="#FF2C3E50" />
        <SolidColorBrush x:Key="SecondaryColor" Color="#FF3498DB" />
        <SolidColorBrush x:Key="AccentColor" Color="#FF1ABC9C" />
        <SolidColorBrush x:Key="LightBackground" Color="#FFECF0F1" />
        <SolidColorBrush x:Key="DarkText" Color="#FF2C3E50" />
        <SolidColorBrush x:Key="LightText" Color="#FFF5F5F5" />
        <!-- setting global font size-->
        <Style TargetType="{x:Type Control}">
            <Setter Property="FontSize" Value="18"></Setter>
            <Setter Property="FontWeight" Value="Bold"></Setter>
        </Style>
        <Style TargetType="{x:Type TextBox}">
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="#FFBDC3C7" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="5" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Height" Value="30" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
        </Style>

        <Style TargetType="{x:Type Label}">
            <Setter Property="Foreground" Value="{StaticResource DarkText}" />
            <Setter Property="FontSize" Value="18" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="Padding" Value="0,0,5,0" />
        </Style>
        <Style TargetType="{x:Type RadioButton}">
            <Setter Property="FontSize" Value="18"></Setter>
            <Setter Property="FontWeight" Value="Bold"></Setter>
        </Style>

        <Style x:Key="HDIGroupBoxStyle" TargetType="GroupBox">
            <Setter Property="Margin" Value="5" />
            <Setter Property="Padding" Value="10" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="BorderBrush" Value="#FFBDC3C7" />
            <Setter Property="Background" Value="White" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="{StaticResource PrimaryColor}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type GroupBox}">
                        <Border BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="3" Background="{TemplateBinding Background}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Border Grid.Row="0" Background="{StaticResource PrimaryColor}"
                                        CornerRadius="3,3,0,0" Padding="5,2,5,2">
                                    <ContentPresenter ContentSource="Header"
                                                      RecognizesAccessKey="True"
                                                      HorizontalAlignment="Left"
                                                      VerticalAlignment="Center"
                                                      Margin="5,0,0,0" />
                                </Border>
                                <ContentPresenter Grid.Row="1" Margin="{TemplateBinding Padding}" />
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="HDIDataGridStyle" TargetType="DataGrid">
            <Setter Property="AutoGenerateColumns" Value="False" />
            <Setter Property="CanUserAddRows" Value="False" />
            <Setter Property="AlternatingRowBackground" Value="#FFF5F5F5" />
            <Setter Property="GridLinesVisibility" Value="None" />
            <Setter Property="HeadersVisibility" Value="Column" />
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="#FFBDC3C7" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="RowHeaderWidth" Value="0" />
            <Setter Property="SelectionMode" Value="Single" />
            <Setter Property="SelectionUnit" Value="FullRow" />
            <Setter Property="CellStyle">
                <Setter.Value>
                    <Style TargetType="{x:Type DataGridCell}">
                        <Setter Property="BorderThickness" Value="0" />
                        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                        <Setter Property="Padding" Value="5" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type DataGridCell}">
                                    <Border Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="{TemplateBinding BorderThickness}">
                                        <ContentPresenter VerticalAlignment="Center" />
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="{StaticResource SecondaryColor}" />
                                <Setter Property="Foreground" Value="White" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Setter.Value>
            </Setter>
            <Setter Property="ColumnHeaderStyle">
                <Setter.Value>
                    <Style TargetType="{x:Type DataGridColumnHeader}">
                        <Setter Property="Background" Value="{StaticResource PrimaryColor}" />
                        <Setter Property="Foreground" Value="White" />
                        <Setter Property="FontWeight" Value="SemiBold" />
                        <Setter Property="Padding" Value="5" />
                        <Setter Property="BorderThickness" Value="0,0,0,1" />
                        <Setter Property="BorderBrush" Value="{StaticResource SecondaryColor}" />
                        <Setter Property="HorizontalContentAlignment" Value="Center" />
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="HDIButtonStyle" TargetType="Button">
            <Setter Property="Margin" Value="5" />
            <Setter Property="Padding" Value="10,5" />
            <Setter Property="MinWidth" Value="100" />
        </Style>
        <Style TargetType="{x:Type TabControl}">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="{StaticResource PrimaryColor}" />
            <Setter Property="BorderThickness" Value="0" />
        </Style>

        <Style TargetType="{x:Type TabItem}">
            <Setter Property="Background" Value="#FFBDC3C7" />
            <Setter Property="BorderBrush" Value="{StaticResource PrimaryColor}" />
            <Setter Property="BorderThickness" Value="1,1,1,0" />
            <Setter Property="Padding" Value="15,5" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="{StaticResource DarkText}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabItem}">
                        <Grid>
                            <Border Name="Border" Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="4,4,0,0" Margin="2,0,2,-1">
                                <ContentPresenter x:Name="ContentSite" VerticalAlignment="Center"
                                                  HorizontalAlignment="Center"
                                                  ContentSource="Header" Margin="10,2" />
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="{StaticResource LightBackground}" />
                                <Setter Property="Foreground" Value="{StaticResource SecondaryColor}" />
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FFD6DBDF" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="{x:Type Button}" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="{StaticResource SecondaryColor}" />
            <Setter Property="Foreground" Value="{StaticResource LightText}" />
            <Setter Property="BorderBrush" Value="{StaticResource PrimaryColor}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="10,5" />
            <Setter Property="Margin" Value="5" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FF2980B9" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#FF1A5276" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="RunButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="{StaticResource AccentColor}" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Width" Value="100" />
            <Setter Property="Height" Value="35" />
            <Setter Property="Margin" Value="10" />
        </Style>

        <Style x:Key="ExitButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="#FFE74C3C" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Width" Value="100" />
            <Setter Property="Height" Value="35" />
            <Setter Property="Margin" Value="10" />
        </Style>

    </Window.Resources>

    <Grid Background="{StaticResource LightBackground}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="27*" />
            <ColumnDefinition Width="53*" />
        </Grid.ColumnDefinitions>
        <TextBlock HorizontalAlignment="Left" Height="34" Margin="48,10,0,0" TextWrapping="Wrap"
                   VerticalAlignment="Top" FontFamily="PMingLiU-ExtB" FontSize="24" FontWeight="Bold" Grid.Column="1">
            <Run Language="zh-tw" Text="瑞太褔板框程式" />
        </TextBlock>

        <TabControl Margin="0,44,0,0" Grid.ColumnSpan="2">
            <TabItem Header="排板設定">
                <Grid Margin="10">
                    <Grid.Background>
                        <SolidColorBrush Color="#FFF5F5F5" />
                    </Grid.Background>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <GroupBox Grid.Row="0" Header="基本設置" Margin="5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Content=" 工作排板" HorizontalAlignment="Left" Margin="26,21,0,0" VerticalAlignment="Top" />
                            <ComboBox x:Name="stpSlect" HorizontalAlignment="Left" Margin="128,20,0,0" VerticalAlignment="Top"
                              Width="120" SelectionChanged="stpSlect_SelectionChanged" />

                            <Label Content="成型尺寸(X)" HorizontalAlignment="Left" Margin="15,62,0,0" VerticalAlignment="Top" />
                            <TextBox x:Name="six" HorizontalAlignment="Left" Margin="130,60,0,0" TextWrapping="Wrap" Text=""
                             VerticalAlignment="Top" Width="120" TextChanged="six_TextChanged"
                             GotFocus="TextBox_GotFocus" />

                            <Label Content="成型尺寸(Y)" HorizontalAlignment="Left" Margin="255,56,0,0" VerticalAlignment="Top" />
                            <TextBox x:Name="siy" HorizontalAlignment="Left" Margin="368,61,0,0" TextWrapping="Wrap" Text=""
                             VerticalAlignment="Top" Width="120" TextChanged="siy_TextChanged"
                             GotFocus="TextBox_GotFocus" />

                            <Label Content="下料尺寸(X)" HorizontalAlignment="Left" Margin="15,100,0,0" VerticalAlignment="Top" />
                            <TextBox x:Name="wix" HorizontalAlignment="Left" Margin="130,98,0,0" TextWrapping="Wrap" Text=""
                             VerticalAlignment="Top" Width="120" TextChanged="wix_TextChanged"
                             GotFocus="TextBox_GotFocus" />

                            <Label Content="下料尺寸(Y)" HorizontalAlignment="Left" Margin="255,95,0,0" VerticalAlignment="Top" />
                            <TextBox x:Name="wiy" HorizontalAlignment="Left" Margin="368,99,0,0" TextWrapping="Wrap" Text=""
                             VerticalAlignment="Top" Width="120" TextChanged="wiy_TextChanged"
                             GotFocus="TextBox_GotFocus" />

                            <Label Content="排板數(X)" HorizontalAlignment="Left" Margin="15,137,0,0" VerticalAlignment="Top" />
                            <TextBox x:Name="xstep_num" HorizontalAlignment="Left" Margin="130,135,0,0" TextWrapping="Wrap"
                             Text=""
                             VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus" />

                            <Label Content="排板數(Y)" HorizontalAlignment="Left" Margin="255,131,0,0" VerticalAlignment="Top" />
                            <TextBox x:Name="ystep_num" HorizontalAlignment="Left" Margin="368,135,0,0" TextWrapping="Wrap"
                             Text=""
                             VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"
                             RenderTransformOrigin="0,0" />

                            <Label Content="排間距板(X)" HorizontalAlignment="Left" Margin="15,178,0,0" VerticalAlignment="Top" />
                            <TextBox x:Name="xstep_spec" HorizontalAlignment="Left" Margin="130,174,0,0" TextWrapping="Wrap"
                             Text=""
                             VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus" Grid.RowSpan="4" />

                            <Label Content="排板間距(Y)" HorizontalAlignment="Left" Margin="255,178,0,0" VerticalAlignment="Top" />
                            <TextBox x:Name="ystep_spec" HorizontalAlignment="Left" Margin="368,174,0,0" TextWrapping="Wrap"
                             Text=""
                             VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"
                             RenderTransformOrigin="0,0" Grid.RowSpan="4"/>

                            <Label Content="成品板厚" HorizontalAlignment="Left" Margin="529,16,0,0" VerticalAlignment="Top" />
                            <TextBox x:Name="cu_thkness" HorizontalAlignment="Left" Margin="602,9,0,0" TextWrapping="Wrap"
                             Text="63" VerticalAlignment="Top" Width="50" FontFamily="Verdana" FontWeight="Bold"
                             FontSize="16" TextAlignment="Center" />

                            <Label Content="排板角度" HorizontalAlignment="Left" Margin="529,52,0,0" VerticalAlignment="Top" />
                            <ComboBox x:Name="shipRotate" HorizontalAlignment="Left" Margin="604,52,0,0"
                              VerticalAlignment="Top" Width="50" Height="27"
                              SelectionChanged="shipRotate_SelectionChanged" RenderTransformOrigin="1.287,0.455" />
                            <Label Content="單位" HorizontalAlignment="Left" Margin="556,85,0,0" VerticalAlignment="Top"
                           RenderTransformOrigin="1.161,0.424" />
                            <ComboBox x:Name="unit_mminch" HorizontalAlignment="Left" Margin="604,88,0,0"
                              VerticalAlignment="Top" Width="50" SelectionChanged="unit_mminch_SelectionChanged" />

                            <Label Content="MIL" HorizontalAlignment="Left" Margin="659,16,0,0" VerticalAlignment="Top"
                           RenderTransformOrigin="-4.54,1.68" AutomationProperties.ItemType="double" />

                            <CheckBox x:Name="StaticFrame" Content="固定板框" Margin="516,138,47,0"
                              VerticalAlignment="Top" FontFamily="Microsoft YaHei" FontWeight="Bold" Background="White"
                              Height="23" />

                            <CheckBox x:Name="need_mount_hole" Content="內層增加鉚釘孔" HorizontalAlignment="Left"
                              Margin="516,173,0,0" VerticalAlignment="Top" FontFamily="Microsoft YaHei"
                              FontWeight="Bold" />
                        </Grid>
                    </GroupBox>


                    <Label Content="線寬" Margin="145,249,0,0" VerticalAlignment="Top"
                           RenderTransformOrigin="2.678,4.005" HorizontalAlignment="Left" />
                    <StackPanel Margin="17,282,0,0" Orientation="Horizontal" VerticalAlignment="Top"
                                HorizontalAlignment="Left">
                        <Label Content="外層(原稿)" RenderTransformOrigin="2.678,4.005" />
                        <TextBox x:Name="outter_orig_space" TextWrapping="Wrap" Text=""
                                 Width="100" GotFocus="TextBox_GotFocus" Margin="0,3,3,0" />
                        <TextBox x:Name="outter_orig_ring" TextWrapping="Wrap" Text=""
                                 Width="100" GotFocus="TextBox_GotFocus" Margin="0,3,3,0" />
                        <TextBox x:Name="outter_orig_width" TextWrapping="Wrap" Text=""
                                 Width="100" GotFocus="TextBox_GotFocus" Margin="0,3,3,0" />
                    </StackPanel>
                    <StackPanel HorizontalAlignment="Left" Margin="17,316,0,0" Orientation="Horizontal"
                                VerticalAlignment="Top">
                        <Label Content="外層(工作)" RenderTransformOrigin="2.678,4.005" />
                        <TextBox x:Name="outter_work_width" TextWrapping="Wrap" Text=""
                                 Width="100" GotFocus="TextBox_GotFocus" Margin="0,3,3,0" />
                        <TextBox x:Name="outter_work_space" TextWrapping="Wrap" Text=""
                                 Width="100" GotFocus="TextBox_GotFocus" Margin="0,3,3,0" />
                        <TextBox x:Name="outter_work_ring" TextWrapping="Wrap" Text=""
                                 Width="100" GotFocus="TextBox_GotFocus" Margin="0,3,3,0" />
                    </StackPanel>
                    <StackPanel HorizontalAlignment="Left" Margin="17,349,0,0" Orientation="Horizontal"
                                VerticalAlignment="Top">
                        <Label Content="內層(原稿)" RenderTransformOrigin="2.678,4.005" />
                        <TextBox x:Name="inner_orig_width" TextWrapping="Wrap" Text=""
                                 Width="100" GotFocus="TextBox_GotFocus" Margin="0,3,3,0" />
                        <TextBox x:Name="inner_orig_space" TextWrapping="Wrap" Text=""
                                 Width="100" GotFocus="TextBox_GotFocus" Margin="0,3,3,0" />
                        <TextBox x:Name="inner_orig_ring" TextWrapping="Wrap" Text=""
                                 Width="100" GotFocus="TextBox_GotFocus" Margin="0,3,3,0" />
                    </StackPanel>
                    <StackPanel HorizontalAlignment="Left" Margin="17,382,0,0" Orientation="Horizontal"
                                VerticalAlignment="Top">
                        <Label Content="內層(工作)" RenderTransformOrigin="2.678,4.005" />
                        <TextBox x:Name="inner_work_width" TextWrapping="Wrap" Text=""
                                 Width="100" GotFocus="TextBox_GotFocus" Margin="0,3,3,0" />
                        <TextBox x:Name="inner_work_space" TextWrapping="Wrap" Text=""
                                 Width="100" GotFocus="TextBox_GotFocus" Margin="0,3,3,0" />
                        <TextBox x:Name="inner_work_ring" TextWrapping="Wrap" Text=""
                                 Width="100" GotFocus="TextBox_GotFocus" Margin="0,3,3,0" />
                    </StackPanel>
                    <Label Content="間距" Margin="251,249,0,0" VerticalAlignment="Top"
                           RenderTransformOrigin="2.678,4.005" HorizontalAlignment="Left" />
                    <Label Content="RING" Margin="335,249,0,0" VerticalAlignment="Top"
                           RenderTransformOrigin="2.678,4.005" HorizontalAlignment="Left" />
                    <Label Content="外層" Margin="20,36,0,0" VerticalAlignment="Top"
                           RenderTransformOrigin="2.678,4.005" HorizontalAlignment="Left" Grid.Row="1" />
                    <RadioButton x:Name="outter_pos" Content="正片" HorizontalAlignment="Left" Margin="71,39,0,0"
                                 VerticalAlignment="Top" VerticalContentAlignment="Center" GroupName="outer_pos_neg"
                                 IsChecked="False" Grid.Row="1" />
                    <RadioButton x:Name="outter_neg" Content="負片" HorizontalAlignment="Left" Margin="136,39,0,0"
                                 VerticalAlignment="Top" VerticalContentAlignment="Center" GroupName="outer_pos_neg"
                                 IsChecked="True" Grid.Row="1" />
                    <Label Content=" 最小下墨間距" HorizontalAlignment="Left" Margin="12,73,0,0" VerticalAlignment="Top"
                           Grid.Row="1" />
                    <TextBox x:Name="min_dam_size" HorizontalAlignment="Left" Margin="132,70,0,0" TextWrapping="Wrap"
                             Text="4" VerticalAlignment="Top" Width="54" HorizontalContentAlignment="Center"
                             Grid.Row="1" />
                    <Label Content="MIL" HorizontalAlignment="Left" Margin="195,74,0,0" VerticalAlignment="Top"
                           RenderTransformOrigin="0.318,0.601" AutomationProperties.ItemType="double" Grid.Row="1" />
                    <Label Content="週期" HorizontalAlignment="Left" Margin="18,186,0,0" VerticalAlignment="Top"
                           Grid.Row="1" />
                    <RadioButton x:Name="dc_yyww" Content="先年後週" HorizontalAlignment="Left" Margin="69,180,0,0"
                                 VerticalAlignment="Top" RenderTransformOrigin="0.72,-1.606" IsChecked="True"
                                 Grid.Row="1" />
                    <RadioButton x:Name="dc_wwyy" Content="先週後年" HorizontalAlignment="Left" Margin="69,202,0,0"
                                 VerticalAlignment="Top" Grid.Row="1" />
                    <Label Content="層別" HorizontalAlignment="Left" Margin="182,191,0,0" VerticalAlignment="Top"
                           RenderTransformOrigin="0.071,0.362" Grid.Row="1" />
                    <ComboBox x:Name="dc_lyr_sel" HorizontalAlignment="Left" Margin="233,186,0,0"
                              VerticalAlignment="Top" Width="77" Grid.Row="1" />
                    <Label Content="切片孔RING" HorizontalAlignment="Left" Margin="17,112,0,0" VerticalAlignment="Top"
                           RenderTransformOrigin="0.319,0.535" Grid.Row="1" />
                    <TextBox x:Name="smallest_hole_ring" HorizontalAlignment="Left" Margin="132,109,0,0"
                             TextWrapping="Wrap" Text="6" VerticalAlignment="Top" Width="54" TextAlignment="Center"
                             Grid.Row="1" />
                    <Label Content="MIL" HorizontalAlignment="Left" Margin="193,113,0,0" VerticalAlignment="Top"
                           RenderTransformOrigin="0.318,0.601" AutomationProperties.ItemType="double" Grid.Row="1" />
                    <Label Content="（單位:Mil)" HorizontalAlignment="Left" Margin="17,249,0,0" VerticalAlignment="Top"
                           RenderTransformOrigin="2.27,1.925" />
                    <Button x:Name="run_btn" Content="執行" Margin="0,0,98,19"
                            Click="onclick_run_btn"
                            HorizontalAlignment="Right" VerticalAlignment="Bottom" Width="73"
                            FontFamily="Microsoft YaHei UI" Height="27" Grid.Row="4" Background="#FF72761A" />
                    <Button x:Name="exit_btn" Content="退出" Margin="0,0,11,19" Background="#FFB76363"
                            Click="onclick_exit_btn"
                            HorizontalAlignment="Right" VerticalAlignment="Bottom" Width="73"
                            FontFamily="Microsoft YaHei UI" Height="27" Grid.Row="4" />
                    <Rectangle HorizontalAlignment="Left" Height="65" Margin="10,170,0,0" Grid.RowSpan="4" Grid.Row="1" Stroke="Black" VerticalAlignment="Top" Width="321"/>
                </Grid>
            </TabItem>

            <TabItem Header="層別預覽">
                <Grid>
                    <ListView x:Name="layerListView" Margin="10">
                        <ListView.Resources>
                            <CollectionViewSource x:Key="GroupedLayers" Source="{Binding}">
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="Category" />
                                </CollectionViewSource.GroupDescriptions>
                            </CollectionViewSource>
                        </ListView.Resources>
                        <ListView.ItemsSource>
                            <Binding Source="{StaticResource GroupedLayers}" />
                        </ListView.ItemsSource>
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="層別" Width="100" DisplayMemberBinding="{Binding Name}" />
                                <GridViewColumn Header="狀態" Width="80" DisplayMemberBinding="{Binding Status}" />
                                <GridViewColumn Header="描述" Width="200" DisplayMemberBinding="{Binding Description}" />
                            </GridView>
                        </ListView.View>
                        <ListView.GroupStyle>
                            <GroupStyle>
                                <GroupStyle.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock FontWeight="Bold" FontSize="14" Text="{Binding Name}"
                                                   Margin="0,5,0,0" />
                                    </DataTemplate>
                                </GroupStyle.HeaderTemplate>
                            </GroupStyle>
                        </ListView.GroupStyle>
                    </ListView>
                </Grid>
            </TabItem>
            <TabItem Header="HDI壓合參數">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!-- 盲埋孔管理區域 -->
                    <GroupBox Grid.Row="0" Header="盲埋孔管理" Style="{StaticResource HDIGroupBoxStyle}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!-- 盲埋孔列表 -->
                            <DataGrid Grid.Column="0" x:Name="blindViasDataGrid"
                                      Style="{StaticResource HDIDataGridStyle}"
                                      ItemsSource="{Binding BlindVias}"
                                      SelectedItem="{Binding SelectedBlindVia}" Grid.ColumnSpan="2" Margin="0,0,10,0">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="名稱" Binding="{Binding Name}" Width="120" />
                                    <DataGridTextColumn Header="起始層" Binding="{Binding StartLayer}" Width="100" />
                                    <DataGridTextColumn Header="結束層" Binding="{Binding EndLayer}" Width="100" />
                                    <DataGridTextColumn Header="鑽孔類型" Binding="{Binding DrillType}" Width="120" />
                                </DataGrid.Columns>
                            </DataGrid>

                            <!-- 盲埋孔操作面板 -->
                        </Grid>
                    </GroupBox>

                    <!-- 壓合參數管理區域 -->
                    <GroupBox Grid.Row="1" Header="壓合參數管理" Style="{StaticResource HDIGroupBoxStyle}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!-- 壓合參數列表 -->
                            <DataGrid Grid.Column="0" x:Name="laminationParametersDataGrid"
                                      Style="{StaticResource HDIDataGridStyle}"
                                      ItemsSource="{Binding LaminationParameters}"
                                      SelectedItem="{Binding SelectedLaminationParameter}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="壓合順序" Binding="{Binding ProcessStep}" Width="60" />
                                    <DataGridTextColumn Header="起始層別" Binding="{Binding LaminationStartLayer}"
                                                        Width="60" />
                                    <DataGridTextColumn Header="結束層別" Binding="{Binding LaminationEndLayer}"
                                                        Width="60" />
                                    <DataGridTextColumn Header="PP數量" Binding="{Binding PPNumber}" Width="60" />
                                    <DataGridTextColumn Header="壓合尺寸X (MM)" Binding="{Binding LaminCutEdgeX}" Width="150" />
                                    <DataGridTextColumn Header="Y (MM)" Binding="{Binding LaminCutEdgeY}" Width="150" />
                                </DataGrid.Columns>
                            </DataGrid>

                            <!-- 壓合參數操作面板 -->
                            <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                <TextBlock Text="壓合參數操作" FontWeight="Bold" Margin="0,0,0,10" />
                                <Button Content="新增壓合參數" Style="{StaticResource HDIButtonStyle}"
                                        Click="AddLaminationParameter_Click" />
                                <Button Content="刪除參數" Style="{StaticResource HDIButtonStyle}"
                                        Click="DeleteLaminationParameter_Click" MinWidth="97" />

                                <!-- 壓合參數詳細資訊 -->
                                <GroupBox Header="參數設定" Margin="0,20,0,0" Style="{StaticResource HDIGroupBoxStyle}">
                                    <StackPanel DataContext="{Binding SelectedLaminationParameter}">
                                        <TextBlock Text="製程步驟：" />
                                        <TextBox Text="{Binding ProcessStep, UpdateSourceTrigger=PropertyChanged}"
                                                 Margin="0,0,0,10" />

                                        <TextBlock Text="關聯盲埋孔：" />
                                        <ComboBox x:Name="associatedViaComboBox"
                                                  ItemsSource="{Binding DataContext.BlindVias, RelativeSource={RelativeSource AncestorType=Window}}"
                                                  DisplayMemberPath="Name"
                                                  SelectedValuePath="Name"
                                                  SelectedValue="{Binding AssociatedVia, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                </GroupBox>
                            </StackPanel>
                        </Grid>
                    </GroupBox>

                    <!-- 操作控制區域 -->
                    <GroupBox Grid.Row="2" Header="關聯操作" Style="{StaticResource HDIGroupBoxStyle}">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button Content="建立關聯" Style="{StaticResource HDIButtonStyle}" Background="LightBlue"
                                    Click="CreateAssociation_Click" />
                            <Button Content="清除關聯" Style="{StaticResource HDIButtonStyle}" Background="LightCoral"
                                    Click="ClearAssociation_Click" />
                            <Button Content="儲存設定" Style="{StaticResource HDIButtonStyle}" Background="LightGreen"
                                    Click="SaveHDISettings_Click" />
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>